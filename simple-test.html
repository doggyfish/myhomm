<!DOCTYPE html>
<html>
<head>
    <title>Simple Test Debug</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .result { padding: 10px; margin: 5px; border-radius: 3px; }
        .pass { background: #d4edda; color: #155724; }
        .fail { background: #f8d7da; color: #721c24; }
        button { padding: 10px 20px; margin: 5px; }
    </style>
</head>
<body>
    <h1>Debug Test</h1>
    <button onclick="runSimpleTest()">Run Simple Test</button>
    <div id="results"></div>
    
    <canvas id="gameCanvas" width="400" height="300" style="border: 1px solid #ccc;"></canvas>

    <script src="game.js"></script>
    <script>
        function log(message, isError = false) {
            const div = document.createElement('div');
            div.className = `result ${isError ? 'fail' : 'pass'}`;
            div.textContent = message;
            document.getElementById('results').appendChild(div);
            console.log(message);
        }
        
        function runSimpleTest() {
            document.getElementById('results').innerHTML = '';
            
            try {
                log("üöÄ Starting simple test...");
                
                // Test 1: Check if MyHoMMGame class exists
                if (typeof MyHoMMGame === 'undefined') {
                    log("‚ùå MyHoMMGame class not found", true);
                    return;
                }
                log("‚úÖ MyHoMMGame class found");
                
                // Test 2: Try to create game instance
                log("Creating game instance...");
                window.testMode = true; // Prevent automatic game loop
                const game = new MyHoMMGame();
                log("‚úÖ Game instance created");
                
                // Test 3: Check basic properties
                if (game.players && game.players.length === 3) {
                    log("‚úÖ Game has 3 players");
                } else {
                    log(`‚ùå Game players issue: ${game.players ? game.players.length : 'undefined'}`, true);
                }
                
                if (game.castles && game.castles.length === 3) {
                    log("‚úÖ Game has 3 castles");
                } else {
                    log(`‚ùå Game castles issue: ${game.castles ? game.castles.length : 'undefined'}`, true);
                }
                
                if (game.armies && game.armies.length === 0) {
                    log("‚úÖ Game starts with 0 armies");
                } else {
                    log(`‚ùå Game armies issue: ${game.armies ? game.armies.length : 'undefined'}`, true);
                }
                
                // Test 4: Try castle selection
                if (game.castles.length > 0) {
                    const castle = game.castles[0];
                    game.selectCastle(castle);
                    
                    if (castle.selected) {
                        log("‚úÖ Castle selection works");
                    } else {
                        log("‚ùå Castle selection failed", true);
                    }
                }
                
                // Test 5: Try army creation
                if (game.castles.length > 0) {
                    const initialArmyCount = game.armies.length;
                    game.sendArmyFromCastle(game.castles[0], 5, 5);
                    
                    if (game.armies.length === initialArmyCount + 1) {
                        log("‚úÖ Army creation works");
                    } else {
                        log("‚ùå Army creation failed", true);
                    }
                }
                
                log("üéâ Simple test completed!");
                
            } catch (error) {
                log(`‚ùå Test failed with error: ${error.message}`, true);
                console.error(error);
            }
        }
    </script>
</body>
</html>